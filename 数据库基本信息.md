# VirtuaLive æ•°æ®åº“åŸºæœ¬ä¿¡æ¯

## æ•°æ®åº“æ¦‚è§ˆ

- **æ•°æ®åº“å**: `virtuallive_dev`
- **å­—ç¬¦é›†**: `utf8mb4`
- **æ’åºè§„åˆ™**: `utf8mb4_unicode_ci`
- **æ€»è¡¨æ•°**: 32 ä¸ª
- **ç”¨æˆ·**: `virtual_live`
- **å¯†ç **: `123`
- **ç«¯å£**: `3307`

---

## ğŸ“Š æ•°æ®åº“è¡¨è¯¦æƒ…

### 1. users - ç”¨æˆ·è¡¨

å­˜å‚¨å¹³å°æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯ï¼ˆVTuberã€åˆ›ä½œè€…ã€ç²‰ä¸ã€å•†æˆ·ï¼‰

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| user_id | INT | NO | PRI | ç”¨æˆ·IDï¼ˆè‡ªå¢ï¼‰ |
| username | VARCHAR(50) | NO | UNI | ç”¨æˆ·åï¼ˆå”¯ä¸€ï¼‰ |
| email | VARCHAR(100) | NO | UNI | é‚®ç®±ï¼ˆå”¯ä¸€ï¼‰ |
| password_hash | VARCHAR(255) | NO | | å¯†ç å“ˆå¸Œ |
| phone | VARCHAR(20) | YES | | ç”µè¯å·ç  |
| user_type | ENUM('vtuber','creator','fan','merchant') | NO | | ç”¨æˆ·ç±»å‹ |
| avatar_url | VARCHAR(500) | YES | | å¤´åƒURL |
| introduction | TEXT | YES | | ä¸ªäººä»‹ç» |
| registration_date | TIMESTAMP | NO | | æ³¨å†Œæ—¶é—´ |
| last_login | TIMESTAMP | YES | | æœ€åç™»å½•æ—¶é—´ |
| status | ENUM('active','banned','inactive') | NO | | è´¦æˆ·çŠ¶æ€ |

**ç´¢å¼•**: idx_username, idx_email, idx_user_type

---

### 2. user_wallet - ç”¨æˆ·èµ„é‡‘è´¦æˆ·

å­˜å‚¨ç”¨æˆ·çš„ä½™é¢å’Œæ”¶ç›Šä¿¡æ¯

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| wallet_id | INT | NO | PRI | é’±åŒ…ID |
| user_id | INT | NO | UNI | ç”¨æˆ·IDï¼ˆå¤–é”®ï¼‰ |
| balance | DECIMAL(12,2) | NO | | è´¦æˆ·ä½™é¢ |
| total_earned | DECIMAL(12,2) | NO | | æ€»æ”¶å…¥ |
| total_spent | DECIMAL(12,2) | NO | | æ€»æ”¯å‡º |
| updated_at | TIMESTAMP | NO | | æ›´æ–°æ—¶é—´ |

**å¤–é”®**: user_id â†’ users(user_id)  
**ç´¢å¼•**: idx_user_id

---

### 3. user_follows - ç”¨æˆ·å…³æ³¨å…³ç³»

å­˜å‚¨ç”¨æˆ·ä¹‹é—´çš„å…³æ³¨å’Œå±è”½å…³ç³»

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| follow_id | INT | NO | PRI | å…³æ³¨ID |
| follower_id | INT | NO | | ç²‰ä¸IDï¼ˆå¤–é”®ï¼‰ |
| following_id | INT | NO | | è¢«å…³æ³¨äººIDï¼ˆå¤–é”®ï¼‰ |
| follow_date | TIMESTAMP | NO | | å…³æ³¨æ—¶é—´ |
| is_blocked | BOOLEAN | NO | | æ˜¯å¦å±è”½ |

**å¤–é”®**: follower_id, following_id â†’ users(user_id)  
**å”¯ä¸€çº¦æŸ**: unique_follow (follower_id, following_id)  
**ç´¢å¼•**: idx_follower, idx_following

---

### 4. fan_badges - ç²‰ä¸å‹‹ç« 

å­˜å‚¨ç²‰ä¸åœ¨ä¸»æ’­çš„å‹‹ç« ä¿¡æ¯

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| badge_id | INT | NO | PRI | å‹‹ç« ID |
| vtuber_id | INT | NO | | ä¸»æ’­IDï¼ˆå¤–é”®ï¼‰ |
| fan_id | INT | NO | | ç²‰ä¸IDï¼ˆå¤–é”®ï¼‰ |
| badge_level | INT | NO | | å‹‹ç« ç­‰çº§ |
| badge_name | VARCHAR(100) | YES | | å‹‹ç« åç§° |
| acquired_date | TIMESTAMP | NO | | è·å¾—æ—¶é—´ |

**å¤–é”®**: vtuber_id, fan_id â†’ users(user_id)  
**ç´¢å¼•**: idx_vtuber, idx_fan

---

### 5. live_rooms - ç›´æ’­é—´

å­˜å‚¨ä¸»æ’­çš„ç›´æ’­é—´ä¿¡æ¯

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| room_id | INT | NO | PRI | ç›´æ’­é—´ID |
| vtuber_id | INT | NO | | ä¸»æ’­IDï¼ˆå¤–é”®ï¼‰ |
| room_title | VARCHAR(200) | NO | | ç›´æ’­é—´æ ‡é¢˜ |
| description | TEXT | YES | | ç›´æ’­é—´æè¿° |
| category | VARCHAR(50) | YES | | ç›´æ’­åˆ†ç±» |
| thumbnail_url | VARCHAR(500) | YES | | ç¼©ç•¥å›¾URL |
| is_live | BOOLEAN | NO | | æ˜¯å¦æ­£åœ¨ç›´æ’­ |
| stream_key | VARCHAR(255) | YES | UNI | æ¨æµå¯†é’¥ |
| rtmp_server | VARCHAR(255) | YES | | RTMPæœåŠ¡å™¨ |
| created_at | TIMESTAMP | NO | | åˆ›å»ºæ—¶é—´ |

**å¤–é”®**: vtuber_id â†’ users(user_id)  
**ç´¢å¼•**: idx_vtuber, idx_is_live

---

### 6. live_sessions - ç›´æ’­ä¼šè¯

å­˜å‚¨æ¯æ¬¡ç›´æ’­çš„ä¼šè¯æ•°æ®

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| session_id | INT | NO | PRI | ä¼šè¯ID |
| room_id | INT | NO | | ç›´æ’­é—´IDï¼ˆå¤–é”®ï¼‰ |
| start_time | TIMESTAMP | NO | | å¼€å§‹æ—¶é—´ |
| end_time | TIMESTAMP | YES | | ç»“æŸæ—¶é—´ |
| duration_minutes | INT | YES | | ç›´æ’­æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰ |
| viewer_count | INT | NO | | è§‚çœ‹äººæ•° |
| peak_viewers | INT | NO | | æœ€é«˜åœ¨çº¿äººæ•° |
| total_gifts_revenue | DECIMAL(12,2) | NO | | ç¤¼ç‰©æ€»æ”¶å…¥ |

**å¤–é”®**: room_id â†’ live_rooms(room_id)  
**ç´¢å¼•**: idx_room, idx_start_time

---

### 7. danmaku - å¼¹å¹•è®°å½•

å­˜å‚¨ç›´æ’­é—´çš„å¼¹å¹•å†…å®¹

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| danmaku_id | INT | NO | PRI | å¼¹å¹•ID |
| session_id | INT | NO | | ä¼šè¯IDï¼ˆå¤–é”®ï¼‰ |
| user_id | INT | NO | | ç”¨æˆ·IDï¼ˆå¤–é”®ï¼‰ |
| content | TEXT | NO | | å¼¹å¹•å†…å®¹ |
| color | VARCHAR(7) | NO | | å¼¹å¹•é¢œè‰² |
| created_at | TIMESTAMP | NO | | å‘é€æ—¶é—´ |
| is_deleted | BOOLEAN | NO | | æ˜¯å¦åˆ é™¤ |

**å¤–é”®**: session_id â†’ live_sessions(session_id), user_id â†’ users(user_id)  
**ç´¢å¼•**: idx_session, idx_user, idx_created_at

---

### 8. gift_donations - ç¤¼ç‰©æ‰“èµ

å­˜å‚¨ç”¨æˆ·æ‰“èµç¤¼ç‰©çš„è®°å½•

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| donation_id | INT | NO | PRI | æ‰“èµID |
| session_id | INT | NO | | ä¼šè¯IDï¼ˆå¤–é”®ï¼‰ |
| sender_id | INT | NO | | å‘é€è€…IDï¼ˆå¤–é”®ï¼‰ |
| gift_type | VARCHAR(100) | NO | | ç¤¼ç‰©ç±»å‹ |
| gift_name | VARCHAR(100) | YES | | ç¤¼ç‰©åç§° |
| gift_value | DECIMAL(12,2) | NO | | ç¤¼ç‰©ä»·å€¼ |
| quantity | INT | NO | | æ•°é‡ |
| total_value | DECIMAL(12,2) | NO | | æ€»ä»·å€¼ |
| donation_time | TIMESTAMP | NO | | æ‰“èµæ—¶é—´ |

**å¤–é”®**: session_id â†’ live_sessions(session_id), sender_id â†’ users(user_id)  
**ç´¢å¼•**: idx_session, idx_sender, idx_donation_time

---

### 9. live_playbacks - ç›´æ’­å›æ”¾

å­˜å‚¨ç›´æ’­å›æ”¾è§†é¢‘ä¿¡æ¯

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| playback_id | INT | NO | PRI | å›æ”¾ID |
| session_id | INT | NO | | ä¼šè¯IDï¼ˆå¤–é”®ï¼‰ |
| video_url | VARCHAR(500) | YES | | è§†é¢‘URL |
| thumbnail_url | VARCHAR(500) | YES | | ç¼©ç•¥å›¾URL |
| duration_minutes | INT | YES | | è§†é¢‘æ—¶é•¿ |
| size_mb | INT | YES | | æ–‡ä»¶å¤§å° |
| status | ENUM('processing','available','deleted') | NO | | å¤„ç†çŠ¶æ€ |
| created_at | TIMESTAMP | NO | | åˆ›å»ºæ—¶é—´ |
| deleted_at | TIMESTAMP | YES | | åˆ é™¤æ—¶é—´ |

**å¤–é”®**: session_id â†’ live_sessions(session_id)  
**ç´¢å¼•**: idx_session, idx_status

---

### 10. view_history - è§‚çœ‹å†å²

å­˜å‚¨ç”¨æˆ·çš„è§‚çœ‹å†å²è®°å½•

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| view_id | INT | NO | PRI | è§‚çœ‹ID |
| user_id | INT | NO | | ç”¨æˆ·IDï¼ˆå¤–é”®ï¼‰ |
| session_id | INT | NO | | ä¼šè¯IDï¼ˆå¤–é”®ï¼‰ |
| watch_start_time | TIMESTAMP | NO | | å¼€å§‹è§‚çœ‹æ—¶é—´ |
| watch_duration_minutes | INT | YES | | è§‚çœ‹æ—¶é•¿ |

**å¤–é”®**: user_id â†’ users(user_id), session_id â†’ live_sessions(session_id)  
**ç´¢å¼•**: idx_user_session (user_id, session_id)

---

### 11. asset_types - è™šæ‹Ÿèµ„äº§ç±»å‹

å­˜å‚¨è™šæ‹Ÿèµ„äº§çš„åˆ†ç±»

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| type_id | INT | NO | PRI | ç±»å‹ID |
| type_name | VARCHAR(100) | NO | UNI | ç±»å‹åç§° |
| description | TEXT | YES | | ç±»å‹æè¿° |
| commission_rate | DECIMAL(5,2) | NO | | ä½£é‡‘æ¯”ç‡ |

**ç´¢å¼•**: idx_type_name

**åˆå§‹æ•°æ®**:
- Live2Dæ¨¡å‹ (20% ä½£é‡‘)
- 3Dæ¨¡å‹ (20% ä½£é‡‘)
- é…éŸ³åŒ… (25% ä½£é‡‘)
- ç‰¹æ•ˆ (20% ä½£é‡‘)
- æœé¥° (20% ä½£é‡‘)

---

### 12. virtual_assets - è™šæ‹Ÿèµ„äº§

å­˜å‚¨åˆ›ä½œè€…ä¸Šä¼ çš„è™šæ‹Ÿèµ„äº§

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| asset_id | INT | NO | PRI | èµ„äº§ID |
| creator_id | INT | NO | | åˆ›ä½œè€…IDï¼ˆå¤–é”®ï¼‰ |
| asset_type_id | INT | NO | | èµ„äº§ç±»å‹IDï¼ˆå¤–é”®ï¼‰ |
| asset_name | VARCHAR(200) | NO | | èµ„äº§åç§° |
| description | TEXT | YES | | èµ„äº§æè¿° |
| preview_image_url | VARCHAR(500) | YES | | é¢„è§ˆå›¾URL |
| tags | VARCHAR(200) | YES | | æ ‡ç­¾ |
| price | DECIMAL(12,2) | YES | | ä»·æ ¼ |
| free_download | BOOLEAN | NO | | æ˜¯å¦å…è´¹ |
| status | ENUM('draft','pending_review','approved','rejected','delisted') | NO | | å®¡æ ¸çŠ¶æ€ |
| download_count | INT | NO | | ä¸‹è½½æ¬¡æ•° |
| purchase_count | INT | NO | | è´­ä¹°æ¬¡æ•° |
| rating | DECIMAL(3,2) | NO | | è¯„åˆ† |
| rating_count | INT | NO | | è¯„åˆ†äººæ•° |
| created_at | TIMESTAMP | NO | | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | NO | | æ›´æ–°æ—¶é—´ |

**å¤–é”®**: creator_id â†’ users(user_id), asset_type_id â†’ asset_types(type_id)  
**ç´¢å¼•**: idx_creator, idx_status, idx_created_at, idx_asset_type

---

### 13. asset_versions - èµ„äº§ç‰ˆæœ¬ç®¡ç†

å­˜å‚¨è™šæ‹Ÿèµ„äº§çš„ç‰ˆæœ¬å†å²

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| version_id | INT | NO | PRI | ç‰ˆæœ¬ID |
| asset_id | INT | NO | | èµ„äº§IDï¼ˆå¤–é”®ï¼‰ |
| version_number | VARCHAR(50) | YES | | ç‰ˆæœ¬å· |
| file_url | VARCHAR(500) | YES | | æ–‡ä»¶URL |
| file_size_mb | INT | YES | | æ–‡ä»¶å¤§å° |
| update_notes | TEXT | YES | | æ›´æ–°è¯´æ˜ |
| release_date | TIMESTAMP | NO | | å‘å¸ƒæ—¶é—´ |
| is_latest | BOOLEAN | NO | | æ˜¯å¦ä¸ºæœ€æ–°ç‰ˆæœ¬ |

**å¤–é”®**: asset_id â†’ virtual_assets(asset_id)  
**ç´¢å¼•**: idx_asset

---

### 14. asset_purchases - èµ„äº§è´­ä¹°è®°å½•

å­˜å‚¨ç”¨æˆ·è´­ä¹°èµ„äº§çš„è®°å½•

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| purchase_id | INT | NO | PRI | è´­ä¹°ID |
| asset_id | INT | NO | | èµ„äº§IDï¼ˆå¤–é”®ï¼‰ |
| buyer_id | INT | NO | | ä¹°å®¶IDï¼ˆå¤–é”®ï¼‰ |
| price_paid | DECIMAL(12,2) | YES | | æ”¯ä»˜ä»·æ ¼ |
| purchase_date | TIMESTAMP | NO | | è´­ä¹°æ—¶é—´ |
| transaction_id | VARCHAR(100) | YES | UNI | äº¤æ˜“ID |
| download_link | VARCHAR(500) | YES | | ä¸‹è½½é“¾æ¥ |
| is_refunded | BOOLEAN | NO | | æ˜¯å¦é€€æ¬¾ |
| refund_date | TIMESTAMP | YES | | é€€æ¬¾æ—¶é—´ |

**å¤–é”®**: asset_id â†’ virtual_assets(asset_id), buyer_id â†’ users(user_id)  
**ç´¢å¼•**: idx_buyer, idx_asset, idx_purchase_date

---

### 15. asset_reviews - èµ„äº§è¯„è®ºä¸è¯„åˆ†

å­˜å‚¨ç”¨æˆ·å¯¹èµ„äº§çš„è¯„åˆ†å’Œè¯„è®º

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| review_id | INT | NO | PRI | è¯„è®ºID |
| asset_id | INT | NO | | èµ„äº§IDï¼ˆå¤–é”®ï¼‰ |
| reviewer_id | INT | NO | | è¯„è®ºè€…IDï¼ˆå¤–é”®ï¼‰ |
| rating | INT | NO | | è¯„åˆ†ï¼ˆ1-5ï¼‰ |
| comment | TEXT | YES | | è¯„è®ºå†…å®¹ |
| created_at | TIMESTAMP | NO | | åˆ›å»ºæ—¶é—´ |
| helpful_count | INT | NO | | æœ‰ç”¨æ•° |

**å¤–é”®**: asset_id â†’ virtual_assets(asset_id), reviewer_id â†’ users(user_id)  
**ç´¢å¼•**: idx_asset, idx_reviewer

---

### 16. creator_revenue - åˆ›ä½œè€…æ”¶ç›Šè®°å½•

å­˜å‚¨åˆ›ä½œè€…çš„æ”¶ç›Šä¿¡æ¯

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| revenue_id | INT | NO | PRI | æ”¶ç›ŠID |
| creator_id | INT | NO | | åˆ›ä½œè€…IDï¼ˆå¤–é”®ï¼‰ |
| asset_id | INT | YES | | èµ„äº§IDï¼ˆå¤–é”®ï¼‰ |
| revenue_type | ENUM('asset_sale','commission','tip') | NO | | æ”¶ç›Šç±»å‹ |
| amount | DECIMAL(12,2) | YES | | é‡‘é¢ |
| commission_rate | DECIMAL(5,2) | YES | | ä½£é‡‘æ¯”ç‡ |
| revenue_date | TIMESTAMP | NO | | æ”¶ç›Šæ—¥æœŸ |
| settlement_status | ENUM('pending','settled','failed') | NO | | ç»“ç®—çŠ¶æ€ |

**å¤–é”®**: creator_id â†’ users(user_id), asset_id â†’ virtual_assets(asset_id)  
**ç´¢å¼•**: idx_creator, idx_revenue_date

---

### 17. community_posts - ç¤¾åŒºæŠ•ç¨¿

å­˜å‚¨ç”¨æˆ·åœ¨ç¤¾åŒºå‘å¸ƒçš„æŠ•ç¨¿

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| post_id | INT | NO | PRI | æŠ•ç¨¿ID |
| author_id | INT | NO | | ä½œè€…IDï¼ˆå¤–é”®ï¼‰ |
| title | VARCHAR(200) | NO | | æ ‡é¢˜ |
| content | LONGTEXT | NO | | å†…å®¹ |
| category | VARCHAR(100) | YES | | åˆ†ç±» |
| tags | VARCHAR(200) | YES | | æ ‡ç­¾ |
| cover_image_url | VARCHAR(500) | YES | | å°é¢å›¾URL |
| likes | INT | NO | | ç‚¹èµæ•° |
| comments_count | INT | NO | | è¯„è®ºæ•° |
| views | INT | NO | | æµè§ˆæ•° |
| is_deleted | BOOLEAN | NO | | æ˜¯å¦åˆ é™¤ |
| created_at | TIMESTAMP | NO | | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | NO | | æ›´æ–°æ—¶é—´ |

**å¤–é”®**: author_id â†’ users(user_id)  
**ç´¢å¼•**: idx_author, idx_category, idx_created_at

---

### 18. comments - è¯„è®º

å­˜å‚¨å¯¹ç¤¾åŒºæŠ•ç¨¿çš„è¯„è®º

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| comment_id | INT | NO | PRI | è¯„è®ºID |
| post_id | INT | YES | | æŠ•ç¨¿IDï¼ˆå¤–é”®ï¼‰ |
| user_id | INT | NO | | ç”¨æˆ·IDï¼ˆå¤–é”®ï¼‰ |
| parent_comment_id | INT | YES | | çˆ¶è¯„è®ºIDï¼ˆå¤–é”®ï¼Œç”¨äºå›å¤ï¼‰ |
| content | TEXT | NO | | è¯„è®ºå†…å®¹ |
| likes | INT | NO | | ç‚¹èµæ•° |
| created_at | TIMESTAMP | NO | | åˆ›å»ºæ—¶é—´ |
| is_deleted | BOOLEAN | NO | | æ˜¯å¦åˆ é™¤ |

**å¤–é”®**: post_id â†’ community_posts(post_id), user_id â†’ users(user_id), parent_comment_id â†’ comments(comment_id)  
**ç´¢å¼•**: idx_post, idx_user, idx_created_at

---

### 19. likes - ç‚¹èµ

å­˜å‚¨ç”¨æˆ·çš„ç‚¹èµè®°å½•

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| like_id | INT | NO | PRI | ç‚¹èµID |
| user_id | INT | NO | | ç”¨æˆ·IDï¼ˆå¤–é”®ï¼‰ |
| content_type | ENUM('post','comment','asset') | NO | | å†…å®¹ç±»å‹ |
| content_id | INT | NO | | å†…å®¹ID |
| created_at | TIMESTAMP | NO | | åˆ›å»ºæ—¶é—´ |

**å¤–é”®**: user_id â†’ users(user_id)  
**å”¯ä¸€çº¦æŸ**: unique_like (user_id, content_type, content_id)  
**ç´¢å¼•**: idx_content (content_type, content_id)

---

### 20. favorites - æ”¶è—

å­˜å‚¨ç”¨æˆ·çš„æ”¶è—è®°å½•

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| favorite_id | INT | NO | PRI | æ”¶è—ID |
| user_id | INT | NO | | ç”¨æˆ·IDï¼ˆå¤–é”®ï¼‰ |
| content_type | ENUM('post','asset','vtuber') | NO | | å†…å®¹ç±»å‹ |
| content_id | INT | NO | | å†…å®¹ID |
| created_at | TIMESTAMP | NO | | åˆ›å»ºæ—¶é—´ |

**å¤–é”®**: user_id â†’ users(user_id)  
**å”¯ä¸€çº¦æŸ**: unique_favorite (user_id, content_type, content_id)  
**ç´¢å¼•**: idx_user_type (user_id, content_type)

---

### 21. discussion_topics - è¯é¢˜è®¨è®ºåŒº

å­˜å‚¨è®¨è®ºè¯é¢˜

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| topic_id | INT | NO | PRI | è¯é¢˜ID |
| title | VARCHAR(200) | NO | | è¯é¢˜æ ‡é¢˜ |
| description | TEXT | YES | | è¯é¢˜æè¿° |
| creator_id | INT | NO | | åˆ›å»ºè€…IDï¼ˆå¤–é”®ï¼‰ |
| category | VARCHAR(100) | YES | | åˆ†ç±» |
| replies_count | INT | NO | | å›å¤æ•° |
| views | INT | NO | | æµè§ˆæ•° |
| pinned | BOOLEAN | NO | | æ˜¯å¦ç½®é¡¶ |
| created_at | TIMESTAMP | NO | | åˆ›å»ºæ—¶é—´ |

**å¤–é”®**: creator_id â†’ users(user_id)  
**ç´¢å¼•**: idx_category, idx_pinned, idx_created_at

---

### 22. discussion_replies - è®¨è®ºåŒºå›å¤

å­˜å‚¨å¯¹è®¨è®ºè¯é¢˜çš„å›å¤

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| reply_id | INT | NO | PRI | å›å¤ID |
| topic_id | INT | NO | | è¯é¢˜IDï¼ˆå¤–é”®ï¼‰ |
| user_id | INT | NO | | ç”¨æˆ·IDï¼ˆå¤–é”®ï¼‰ |
| content | TEXT | NO | | å›å¤å†…å®¹ |
| likes | INT | NO | | ç‚¹èµæ•° |
| created_at | TIMESTAMP | NO | | åˆ›å»ºæ—¶é—´ |

**å¤–é”®**: topic_id â†’ discussion_topics(topic_id), user_id â†’ users(user_id)  
**ç´¢å¼•**: idx_topic, idx_user

---

### 23. user_notifications - æ¶ˆæ¯é€šçŸ¥

å­˜å‚¨ç³»ç»Ÿæ¶ˆæ¯å’Œé€šçŸ¥

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| notification_id | INT | NO | PRI | é€šçŸ¥ID |
| user_id | INT | NO | | ç”¨æˆ·IDï¼ˆå¤–é”®ï¼‰ |
| notification_type | VARCHAR(100) | YES | | é€šçŸ¥ç±»å‹ |
| content | TEXT | YES | | é€šçŸ¥å†…å®¹ |
| related_user_id | INT | YES | | å…³è”ç”¨æˆ·IDï¼ˆå¤–é”®ï¼‰ |
| related_content_type | VARCHAR(50) | YES | | å…³è”å†…å®¹ç±»å‹ |
| related_content_id | INT | YES | | å…³è”å†…å®¹ID |
| is_read | BOOLEAN | NO | | æ˜¯å¦å·²è¯» |
| created_at | TIMESTAMP | NO | | åˆ›å»ºæ—¶é—´ |

**å¤–é”®**: user_id â†’ users(user_id), related_user_id â†’ users(user_id)  
**ç´¢å¼•**: idx_user_read (user_id, is_read), idx_created_at

---

### 24. private_messages - ç§ä¿¡

å­˜å‚¨ç”¨æˆ·ä¹‹é—´çš„ç§ä¿¡

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| message_id | INT | NO | PRI | æ¶ˆæ¯ID |
| sender_id | INT | NO | | å‘é€è€…IDï¼ˆå¤–é”®ï¼‰ |
| receiver_id | INT | NO | | æ¥æ”¶è€…IDï¼ˆå¤–é”®ï¼‰ |
| content | TEXT | NO | | æ¶ˆæ¯å†…å®¹ |
| is_read | BOOLEAN | NO | | æ˜¯å¦å·²è¯» |
| sent_at | TIMESTAMP | NO | | å‘é€æ—¶é—´ |
| read_at | TIMESTAMP | YES | | é˜…è¯»æ—¶é—´ |

**å¤–é”®**: sender_id â†’ users(user_id), receiver_id â†’ users(user_id)  
**ç´¢å¼•**: idx_receiver_read (receiver_id, is_read), idx_sent_at

---

### 25. merchandise - å‘¨è¾¹å•†å“

å­˜å‚¨å‘¨è¾¹å•†å“ä¿¡æ¯

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| merchandise_id | INT | NO | PRI | å•†å“ID |
| creator_id | INT | NO | | åˆ›å»ºè€…IDï¼ˆå¤–é”®ï¼‰ |
| product_name | VARCHAR(200) | NO | | å•†å“åç§° |
| description | TEXT | YES | | å•†å“æè¿° |
| category | VARCHAR(100) | YES | | å•†å“åˆ†ç±» |
| price | DECIMAL(12,2) | YES | | å•†å“ä»·æ ¼ |
| stock_quantity | INT | NO | | åº“å­˜æ•°é‡ |
| product_images | VARCHAR(1000) | YES | | å•†å“å›¾ç‰‡ï¼ˆå¤šä¸ªï¼‰ |
| status | ENUM('draft','pending','listed','sold_out','delisted') | NO | | å•†å“çŠ¶æ€ |
| created_at | TIMESTAMP | NO | | åˆ›å»ºæ—¶é—´ |

**å¤–é”®**: creator_id â†’ users(user_id)  
**ç´¢å¼•**: idx_creator, idx_status

---

### 26. merchandise_inventory - åº“å­˜ç®¡ç†

å­˜å‚¨å•†å“åº“å­˜ä¿¡æ¯

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| inventory_id | INT | NO | PRI | åº“å­˜ID |
| merchandise_id | INT | NO | UNI | å•†å“IDï¼ˆå¤–é”®ï¼‰ |
| quantity_available | INT | NO | | å¯ç”¨æ•°é‡ |
| quantity_reserved | INT | NO | | é¢„ç•™æ•°é‡ |
| last_stock_update | TIMESTAMP | NO | | æœ€åæ›´æ–°æ—¶é—´ |

**å¤–é”®**: merchandise_id â†’ merchandise(merchandise_id)

---

### 27. merchandise_sales - å‘¨è¾¹é”€å”®è®°å½•

å­˜å‚¨å•†å“é”€å”®è®°å½•

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| sale_id | INT | NO | PRI | é”€å”®ID |
| merchandise_id | INT | NO | | å•†å“IDï¼ˆå¤–é”®ï¼‰ |
| buyer_id | INT | NO | | ä¹°å®¶IDï¼ˆå¤–é”®ï¼‰ |
| quantity | INT | NO | | æ•°é‡ |
| price_paid | DECIMAL(12,2) | YES | | æ”¯ä»˜ä»·æ ¼ |
| shipping_address | TEXT | YES | | æ”¶è´§åœ°å€ |
| shipping_status | ENUM('pending','shipped','delivered','returned') | NO | | ç‰©æµçŠ¶æ€ |
| tracking_number | VARCHAR(100) | YES | | å¿«é€’å•å· |
| sale_date | TIMESTAMP | NO | | é”€å”®æ—¶é—´ |

**å¤–é”®**: merchandise_id â†’ merchandise(merchandise_id), buyer_id â†’ users(user_id)  
**ç´¢å¼•**: idx_buyer, idx_merchandise, idx_sale_date

---

### 28. vtuber_avatars - è™šæ‹Ÿä¸»æ’­å½¢è±¡

å­˜å‚¨VTuberçš„è™šæ‹Ÿå½¢è±¡æ¨¡å‹ä¿¡æ¯

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| avatar_id | INT | NO | PRI | å½¢è±¡ID |
| vtuber_id | INT | NO | | ä¸»æ’­IDï¼ˆå¤–é”®ï¼‰ |
| avatar_name | VARCHAR(100) | YES | | å½¢è±¡åç§° |
| model_type | ENUM('live2d','3d','vroid','custom') | NO | | æ¨¡å‹ç±»å‹ |
| model_file_url | VARCHAR(500) | YES | | æ¨¡å‹æ–‡ä»¶URL |
| thumbnail_url | VARCHAR(500) | YES | | ç¼©ç•¥å›¾URL |
| is_primary | BOOLEAN | NO | | æ˜¯å¦ä¸ºä¸»å½¢è±¡ |
| created_at | TIMESTAMP | NO | | åˆ›å»ºæ—¶é—´ |

**å¤–é”®**: vtuber_id â†’ users(user_id)  
**ç´¢å¼•**: idx_vtuber

---

### 29. vtuber_profile - VTuberä¸»é¡µä¿¡æ¯

å­˜å‚¨VTuberçš„é¢‘é“ä¿¡æ¯å’Œç»Ÿè®¡æ•°æ®

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| profile_id | INT | NO | PRI | æ¡£æ¡ˆID |
| vtuber_id | INT | NO | UNI | ä¸»æ’­IDï¼ˆå¤–é”®ï¼‰ |
| channel_name | VARCHAR(200) | YES | | é¢‘é“åç§° |
| bio | TEXT | YES | | ä¸ªäººç®€ä»‹ |
| avatar_id | INT | YES | | å¤´åƒIDï¼ˆå¤–é”®ï¼‰ |
| follower_count | INT | NO | | ç²‰ä¸æ•° |
| total_live_minutes | INT | NO | | æ€»ç›´æ’­æ—¶é•¿ |
| total_revenue | DECIMAL(12,2) | NO | | æ€»æ”¶å…¥ |
| subscription_status | ENUM('free','premium') | NO | | è®¢é˜…çŠ¶æ€ |
| verified | BOOLEAN | NO | | æ˜¯å¦è®¤è¯ |

**å¤–é”®**: vtuber_id â†’ users(user_id), avatar_id â†’ vtuber_avatars(avatar_id)

---

### 30. creator_verification - åˆ›ä½œè€…è®¤è¯

å­˜å‚¨åˆ›ä½œè€…çš„è®¤è¯ä¿¡æ¯

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| verification_id | INT | NO | PRI | è®¤è¯ID |
| creator_id | INT | NO | UNI | åˆ›ä½œè€…IDï¼ˆå¤–é”®ï¼‰ |
| verification_type | VARCHAR(100) | YES | | è®¤è¯ç±»å‹ |
| submission_date | TIMESTAMP | NO | | æäº¤æ—¶é—´ |
| approval_date | TIMESTAMP | YES | | å®¡æ‰¹æ—¶é—´ |
| status | ENUM('pending','approved','rejected') | NO | | è®¤è¯çŠ¶æ€ |

**å¤–é”®**: creator_id â†’ users(user_id)

---

### 31. user_activity_log - ç”¨æˆ·è¡Œä¸ºæ—¥å¿—

å­˜å‚¨ç”¨æˆ·æ´»åŠ¨çš„å®¡è®¡æ—¥å¿—

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| log_id | INT | NO | PRI | æ—¥å¿—ID |
| user_id | INT | NO | | ç”¨æˆ·IDï¼ˆå¤–é”®ï¼‰ |
| action_type | VARCHAR(100) | YES | | æ“ä½œç±»å‹ |
| action_detail | TEXT | YES | | æ“ä½œè¯¦æƒ… |
| ip_address | VARCHAR(45) | YES | | IPåœ°å€ |
| user_agent | TEXT | YES | | ç”¨æˆ·ä»£ç† |
| created_at | TIMESTAMP | NO | | åˆ›å»ºæ—¶é—´ |

**å¤–é”®**: user_id â†’ users(user_id)  
**ç´¢å¼•**: idx_user_date (user_id, created_at)

---

### 32. content_moderation - å†…å®¹å®¡æ ¸è®°å½•

å­˜å‚¨å†…å®¹ä¸¾æŠ¥å’Œå®¡æ ¸è®°å½•

| å­—æ®µå | æ•°æ®ç±»å‹ | æ˜¯å¦ä¸ºç©º | ä¸»é”® | è¯´æ˜ |
|--------|---------|---------|------|------|
| moderation_id | INT | NO | PRI | å®¡æ ¸ID |
| content_type | VARCHAR(100) | YES | | å†…å®¹ç±»å‹ |
| content_id | INT | YES | | å†…å®¹ID |
| content_owner_id | INT | YES | | å†…å®¹æ‰€æœ‰è€…IDï¼ˆå¤–é”®ï¼‰ |
| reported_by_id | INT | YES | | ä¸¾æŠ¥è€…IDï¼ˆå¤–é”®ï¼‰ |
| reason | TEXT | YES | | ä¸¾æŠ¥åŸå›  |
| status | ENUM('pending','approved','rejected') | NO | | å®¡æ ¸çŠ¶æ€ |
| moderator_id | INT | YES | | å®¡æ ¸å‘˜IDï¼ˆå¤–é”®ï¼‰ |
| decision_reason | TEXT | YES | | å®¡æ ¸å†³å®šåŸå›  |
| created_at | TIMESTAMP | NO | | åˆ›å»ºæ—¶é—´ |
| decided_at | TIMESTAMP | YES | | å®¡æ ¸æ—¶é—´ |

**å¤–é”®**: content_owner_id â†’ users(user_id), reported_by_id â†’ users(user_id), moderator_id â†’ users(user_id)  
**ç´¢å¼•**: idx_status, idx_created_at

---

## ğŸ“ˆ æ•°æ®åº“ç»Ÿè®¡

| æŒ‡æ ‡ | å€¼ |
|------|-----|
| **æ€»è¡¨æ•°** | 32 |
| **ç”¨æˆ·ç›¸å…³è¡¨** | 8 ä¸ª |
| **ç›´æ’­ç›¸å…³è¡¨** | 5 ä¸ª |
| **èµ„äº§äº¤æ˜“è¡¨** | 6 ä¸ª |
| **ç¤¾åŒºäº’åŠ¨è¡¨** | 6 ä¸ª |
| **å•†åŸäº¤æ˜“è¡¨** | 3 ä¸ª |
| **ç³»ç»Ÿè¡¨** | 4 ä¸ª |

---

## ğŸ”‘ å…³é”®çº¦æŸ

### å”¯ä¸€çº¦æŸ
- `users.username` - ç”¨æˆ·åå”¯ä¸€
- `users.email` - é‚®ç®±å”¯ä¸€
- `user_wallet.user_id` - æ¯ä¸ªç”¨æˆ·åªæœ‰ä¸€ä¸ªé’±åŒ…
- `user_follows` - æ¯ä¸ªç”¨æˆ·å¯¹å¦ä¸€ç”¨æˆ·åªèƒ½å…³æ³¨ä¸€æ¬¡
- `live_rooms.stream_key` - æ¨æµå¯†é’¥å”¯ä¸€
- `asset_purchases.transaction_id` - äº¤æ˜“IDå”¯ä¸€
- `asset_types.type_name` - èµ„äº§ç±»å‹åç§°å”¯ä¸€
- `likes` - ç”¨æˆ·å¯¹å†…å®¹çš„ç‚¹èµå”¯ä¸€
- `favorites` - ç”¨æˆ·å¯¹å†…å®¹çš„æ”¶è—å”¯ä¸€
- `merchandise_inventory.merchandise_id` - æ¯ä¸ªå•†å“ä¸€ä¸ªåº“å­˜è®°å½•
- `vtuber_profile.vtuber_id` - æ¯ä¸ªä¸»æ’­ä¸€ä¸ªæ¡£æ¡ˆ
- `creator_verification.creator_id` - æ¯ä¸ªåˆ›ä½œè€…ä¸€ä¸ªè®¤è¯è®°å½•

### çº§è”åˆ é™¤
- åˆ é™¤ç”¨æˆ·æ—¶ï¼Œä¼šçº§è”åˆ é™¤å…¶æ‰€æœ‰ç›¸å…³æ•°æ®
- åˆ é™¤è¡¨çš„ä¸»è®°å½•æ—¶ï¼Œä¼šçº§è”åˆ é™¤å…¶å­è¡¨è®°å½•

---

## ğŸ¯ æ ¸å¿ƒä¸šåŠ¡æµç¨‹æ¶‰åŠè¡¨

### ç›´æ’­ä¸šåŠ¡æµç¨‹
```
users â†’ live_rooms â†’ live_sessions â†’ danmaku
                         â†“
                    gift_donations
                         â†“
                   live_playbacks
```

### èµ„äº§äº¤æ˜“æµç¨‹
```
users (creator_id) â†’ virtual_assets â†’ asset_versions
                           â†“
                      asset_purchases
                           â†“
                        asset_reviews
                           â†“
                      creator_revenue
```

### ç¤¾åŒºäº’åŠ¨æµç¨‹
```
users â†’ community_posts â†’ comments â†’ likes
         â†“                            
    favorites
         â†“
   user_notifications
```

---

## ğŸ“ å¤‡æ³¨

- æ‰€æœ‰æ—¶é—´æˆ³ä½¿ç”¨ `TIMESTAMP` ç±»å‹ï¼Œé»˜è®¤å½“å‰æ—¶é—´
- å­—ç¬¦é›†ç»Ÿä¸€ä¸º `utf8mb4`ï¼Œæ”¯æŒè¡¨æƒ…ç¬¦å·
- æ‰€æœ‰è¡¨éƒ½ä½¿ç”¨ `InnoDB` å¼•æ“ï¼Œæ”¯æŒäº‹åŠ¡
- é‡è¦è¡¨éƒ½åˆ›å»ºäº†ç›¸åº”çš„ç´¢å¼•ä»¥æé«˜æŸ¥è¯¢æ€§èƒ½
- éƒ¨åˆ†è¡¨åŒ…å«è½¯åˆ é™¤å­—æ®µï¼ˆ`is_deleted`ï¼‰ç”¨äºæ•°æ®ä¿ç•™

